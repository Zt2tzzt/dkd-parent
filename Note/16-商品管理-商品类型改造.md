# 商品管理之商品类型改造、商品管理改造

## 一、商品类型改造

### 1.1.添加、修改商品类型改造

在数据库中，商品类型的名称，有唯一约束。

添加一段异常处理的逻辑，用于处理添加、修改商品类型，名称重复的异常。

dkd-framework/src/main/java/com/dkd/framework/web/exception/GlobalExceptionHandler.java

```java
/**
 * 此方法用于：处理数据完整性异常
 */
@ExceptionHandler(DataIntegrityViolationException.class)
public AjaxResult handleDataIntegrityViolationException(DataIntegrityViolationException e) {
    log.error("数据完整性异常", e);

    String errMsg = e.getMessage();
    if (errMsg.contains("foreign key"))
        return AjaxResult.error("无法删除，有其它数据引用");

    if (errMsg.contains("emp.user_mobile_uindex"))
        return AjaxResult.error("员工手机号已存在");

    if (errMsg.contains("Duplicate"))
        return AjaxResult.error("无法保存，名称已存在");


    return AjaxResult.error("数据完整性异常，请检查数据是否完整");
}
```

## 二、商品管理改造

商品价格显示，在数据库中使用整型，存储单位为分的价格。

在前端处理成单位为元的形式，进行展示。
# ç‚¹ä½ç®¡ç†ä¹‹åˆä½œå•†ç®¡ç†æ”¹é€ 

## ä¸€ã€åˆä½œå•†åæœç´¢æ¡† label å®½åº¦æ”¹é€ 

è‹¥ä¾è‡ªåŠ¨ç”Ÿæˆçš„åˆä½œå•†åæœç´¢æ¡† label å®½åº¦å¤ªå°ï¼Œå¯¼è‡´äº† label è‡ªåŠ¨æ¢è¡Œã€‚

src/views/manage/partner/index.vue

```vue
<el-form :model="queryParams" ref="queryRef" :inline="true" v-show="showSearch" label-width="90px">
  <el-form-item label="åˆä½œå•†åç§°" prop="name">
    <el-input
      v-model="queryParams.name"
      placeholder="è¯·è¾“å…¥åˆä½œå•†åç§°"
      clearable
      @keyup.enter="handleQuery"
    />
  </el-form-item>
  <el-form-item>
    <el-button type="primary" icon="Search" @click="handleQuery">æœç´¢</el-button>
    <el-button icon="Refresh" @click="resetQuery">é‡ç½®</el-button>
  </el-form-item>
</el-form>
```

- ä¿®æ”¹äº† `label-width="90px"`ã€‚

## äºŒã€ä¸»é”® id label æ”¹é€ 

åœ¨åˆ—è¡¨è§†å›¾é¡µé¢ï¼Œå°†â€ä¸»é”® idâ€œçš„ label æ”¹ä¸ºâ€œåºå·â€ï¼Œå¹¶æä¾›æ’åºçš„åŠŸèƒ½ã€‚

src/views/manage/partner/index.vue

```vue
<el-table-column label="åºå·" type="index" align="center" prop="id" />
```

- `type="index"` ç”¨äºè®¾ç½®æ’åºå…±å—¯ã€‚
- `width="50"` ç”¨äºå¢åŠ åˆ—çš„å®½åº¦ã€‚

## ä¸‰ã€è”ç³»äººã€è”ç³»ç”µè¯ä¾‹æ”¹é€ 

å°†è”ç³»äººã€è”ç³»ç”µè¯åˆ—è°ƒæ•´åˆ°æœ€åã€‚

src/views/manage/partner/index.vue

```vue
<el-table-column type="selection" width="55" align="center" />
<el-table-column label="åºå·" type="index" align="center" prop="id" />
<el-table-column label="åˆä½œå•†åç§°" align="center" prop="name" />
<el-table-column label="è´¦å·" align="center" prop="account" />
<el-table-column label="åˆ†æˆæ¯”ä¾‹" align="center" prop="profitShare" />
<!-- <el-table-column label="å¯†ç " align="center" prop="password" /> -->
<el-table-column label="è”ç³»äºº" align="center" prop="contactPerson" />
<el-table-column label="è”ç³»ç”µè¯" align="center" prop="contactPhone" />
<el-table-column label="æ“ä½œ" align="center" class-name="small-padding fixed-width">
```

## å››ã€åˆ†æˆæ¯”ä¾‹åˆ—æ”¹é€ 

åˆ†æˆæ¯”ä¾‹åˆ—ï¼Œå€¼åæ–¹åŠ ä¸Šç™¾åˆ†å·ã€‚

src/views/manage/partner/index.vue

```vue
<el-table-column label="åˆ†æˆæ¯”ä¾‹" align="center">
  <template #default="scope">
    {{ scope.row.profitShare }}%
  </template>
</el-table-column>
```

## äº”ã€æ“ä½œåˆ—å›¾æ ‡ç§»é™¤

```vue
<el-button link type="primary" icon="Edit" @click="handleUpdate(scope.row)" v-hasPermi="['manage:region:edit']">ä¿®æ”¹</el-button>
<el-button link type="primary" icon="Delete" @click="handleDelete(scope.row)" v-hasPermi="['manage:region:remove']">åˆ é™¤</el-button>

<!-- æ”¹ä¸º ğŸ‘‡ -->

<el-button link type="primary" @click="handleUpdate(scope.row)" v-hasPermi="['manage:partner:edit']">ä¿®æ”¹</el-button>
<el-button link type="primary" @click="handleDelete(scope.row)" v-hasPermi="['manage:partner:remove']">åˆ é™¤</el-button>
```

- å»æ‰äº† `icon="xxx"` å±æ€§ã€‚

## å…­ã€æ·»åŠ /ä¿®æ”¹åˆä½œå•†é¡µé¢æ”¹é€ 

### 6.1.å¯†ç ä½¿ç”¨æ©ç 

src/views/manage/partner/index.vue

```vue
<el-form-item label="å¯†ç " prop="password">
  <el-input v-model="form.password" type="password" placeholder="è¯·è¾“å…¥å¯†ç " />
</el-form-item>
```

- å¢åŠ  `type="password"` å±æ€§ã€‚

### 6.2.åˆä½œå•†åç§° label å®½åº¦

src/views/manage/partner/index.vue

```vue
<el-form ref="partnerRef" :model="form" :rules="rules" label-width="100px">
  â€¦â€¦
</el-form>
```

- ä¿®æ”¹äº† `label-width="100px"` å±æ€§ã€‚

## ä¸ƒã€ä¿®æ”¹åˆä½œå•†é¡µé¢æ”¹é€ 

ä¿®æ”¹åˆä½œå•†é¡µé¢ï¼Œæ²¡æœ‰è´¦å·ã€å¯†ç å­—æ®µï¼›å¹¶ä¸”è¦å±•ç¤ºåˆä½œå•†çš„åˆ›å»ºæ—¶é—´ã€‚

æ€è·¯ï¼š

- ä¿®æ”¹æ“ä½œï¼Œå› ä¸ºä¼šå›æ˜¾æ•°æ®è®°å½•ï¼Œæ‰€ä»¥æœ‰è®°å½• id çš„ï¼›
- æ–°å¢æ“ä½œåˆ™ä¸ä¼šã€‚

src/views/manage/partner/index.vue

```vue
<el-form-item label="åˆ›å»ºæ—¶é—´" prop="createTime" v-if="form.id">
  {{ form.createTime }}
</el-form-item>
<el-form-item label="è´¦å·" prop="account" v-if="!form.id">
  <el-input v-model="form.account" placeholder="è¯·è¾“å…¥è´¦å·" />
</el-form-item>
<el-form-item label="å¯†ç " prop="password" v-if="!form.id">
  <el-input v-model="form.password" type="password" placeholder="è¯·è¾“å…¥å¯†ç " />
</el-form-item>
```

- ä½¿ç”¨ `v-if` åˆ¤æ–­ `form.id` æ˜¯å¦æœ‰å€¼ï¼Œæœ‰åˆ™æ˜¯ä¿®æ”¹é¡µé¢ï¼›å¦åˆ™æ˜¯æ·»åŠ é¡µé¢ã€‚

## å…«ã€å¯†ç åŠ å¯†

ç›®å‰ï¼Œåˆä½œå•†çš„å¯†ç ï¼Œæ˜¯æ˜æ–‡å­˜å‚¨åœ¨æ•°æ®åº“çš„ï¼Œå®‰å…¨æ€§ä½ã€‚

ä½¿ç”¨è‹¥ä¾é›†æˆçš„ Spring Security ä¾èµ–ï¼Œè¿›è¡Œå¯†ç åŠ å¯†å¤„ç†ã€‚

åœ¨ `PartnerServiceImpl` å®ç°ç±»ä¸­ï¼Œæ”¹é€  `insertPartner` æ–¹æ³•ã€‚

dkd-manage/src/main/java/com/dkd/manage/service/impl/PartnerServiceImpl.java

```java
/**
 * æ–°å¢åˆä½œå•†ç®¡ç†
 *
 * @param partner åˆä½œå•†ç®¡ç†
 * @return ç»“æœ
 */
@Override
public int insertPartner(Partner partner)
{
    // ä½¿ç”¨ Spring Security å¯¹å¯†ç è¿›è¡ŒåŠ å¯†å¤„ç†
    partner.setPassword(SecurityUtils.encryptPassword(partner.getPassword()));
    partner.setCreateTime(DateUtils.getNowDate());
    return partnerMapper.insertPartner(partner);
}
```

## ä¹ã€æŸ¥çœ‹è¯¦æƒ…æ”¹é€ 

åœ¨åˆ—è¡¨è§†å›¾çš„â€œæ“ä½œâ€åˆ—ï¼Œæ·»åŠ â€æŸ¥çœ‹è¯¦æƒ…â€œçš„æŒ‰é’®ã€‚

```vue
<template>
  <el-table-column label="æ“ä½œ" align="center" class-name="small-padding fixed-width">
    <template #default="scope">
      <el-button
        link
        type="primary"
        @click="handleDetail(scope.row)"
        v-hasPermi="['manage:partner:query']"
        >æŸ¥çœ‹è¯¦æƒ…</el-button
      >
    </template>
    â€¦â€¦
  </el-table-column>

â€¦â€¦

  <!-- æŸ¥çœ‹è¯¦æƒ…å¯¹è¯æ¡† -->
  <el-dialog title="åˆä½œå•†è¯¦æƒ…" v-model="detailInfoOpen" width="500px" append-to-body>
    <el-row>
      <el-col :span="12">åˆä½œå•†åç§°ï¼š{{ form.name }}</el-col>
      <el-col :span="12">è”ç³»äººï¼š{{ form.contactPerson }}</el-col>
    </el-row>
    <el-row>
      <el-col :span="12">è”ç³»ç”µè¯ï¼š{{ form.contactPhone }}</el-col>
      <el-col :span="12">è”ç³»äººï¼š{{ form.profitShare }}%</el-col>
    </el-row>
  </el-dialog>
</template>

<script>
â€¦â€¦

const detailInfoOpen = ref(false)
/** æŸ¥çœ‹è¯¦æƒ…æŒ‰é’®æ“ä½œ */
const handleDetail = row => {
  reset()
  const _id = row.id || ids.value
  getPartner(_id).then(res => {
    form.value = res.data
    detailInfoOpen.value = true
  })
}

</script>
```

- `manage:partner:query` è¡¨ç¤ºæŸ¥è¯¢æƒé™ã€‚
- `handleDetail` æ˜¯æ–°å¢çš„æ–¹æ³•ï¼Œç”¨æ¥å±•ç¤ºå¯¹è¯æ¡†ã€‚
- `detailInfoOpen` çŠ¶æ€ï¼Œç”¨æ¥è¡¨ç¤ºå¯¹è¯æ¡†çš„å¼€å¯ã€å…³é—­ã€‚

æ–°å¢çš„å¯¹è¯æ¡†é¡µé¢ä¸æ˜¯å¾ˆç¾è§‚ï¼Œä½¿ç”¨ AIGC ä¼˜åŒ–ï¼š

Prompt æç¤ºå·¥ç¨‹è¾“å…¥ï¼š

```markdown
ä½ æ˜¯ä¸€ä¸ªè½¯ä»¶å·¥ç¨‹å¸ˆï¼Œå¸®æˆ‘ä¼˜åŒ–ä¸‹æ–¹ä»£ç ä¸­å¯¹è¯æ¡†ä¸­çš„å¸ƒå±€
<!-- æŸ¥çœ‹è¯¦æƒ…å¯¹è¯æ¡† -->
<el-dialog title="åˆä½œå•†è¯¦æƒ…" v-model="detailInfoOpen" width="500px" append-to-body>
  <el-row>
    <el-col :span="12">åˆä½œå•†åç§°ï¼š{{ form.name }}</el-col>
    <el-col :span="12">è”ç³»äººï¼š{{ form.contactPerson }}</el-col>
  </el-row>
  <el-row>
    <el-col :span="12">è”ç³»ç”µè¯ï¼š{{ form.contactPhone }}</el-col>
    <el-col :span="12">è”ç³»äººï¼š{{ form.profitShare }}%</el-col>
  </el-row>
</el-dialog>
```

AIGC è¾“å‡º

```vue
<!-- æŸ¥çœ‹è¯¦æƒ…å¯¹è¯æ¡† -->
<el-dialog
  title="åˆä½œå•†è¯¦æƒ…"
  v-model="detailInfoOpen"
  width="500px"
  append-to-body
>
  <!-- ä½¿ç”¨æ›´æ¸…æ™°çš„å¸ƒå±€ -->
  <el-row :gutter="20" class="dialog-content">
    <el-col :span="12">
      <strong>åˆä½œå•†åç§°ï¼š</strong> {{ form.name }}
    </el-col>
    <el-col :span="12">
      <strong>è”ç³»äººï¼š</strong> {{ form.contactPerson }}
    </el-col>
  </el-row>
  <el-row :gutter="20" class="dialog-content">
    <el-col :span="12">
      <strong>è”ç³»ç”µè¯ï¼š</strong> {{ form.contactPhone }}
    </el-col>
    <el-col :span="12">
      <strong>åˆ†æ¶¦æ¯”ä¾‹ï¼š</strong> {{ form.profitShare }}%
    </el-col>
  </el-row>
</el-dialog>

<style scoped>
.dialog-content {
  margin-bottom: 10px; /* æ·»åŠ ä¸‹æ–¹é—´è· */
  font-size: 14px;     /* æé«˜å¯è¯»æ€§ */
  line-height: 1.6;    /* å¢åŠ è¡Œé«˜ */
}
</style>
```

- æ·»åŠ  `gutter` å±æ€§ï¼Œå¢åŠ åˆ—ä¹‹é—´çš„é—´è·ï¼Œé¿å…å†…å®¹å¤ªè¿‡ç´§å‡‘ã€‚

## åã€å¢åŠ â€œç‚¹ä½æ•°â€åˆ—

åœ¨åˆä½œå•†ç®¡ç†çš„åˆ—è¡¨è§†å›¾ä¸­ï¼Œå¢åŠ â€œç‚¹ä½æ•°â€åˆ—ã€‚

å‚è€ƒä¸Šæ–‡ã€1.3.å¢åŠ â€œç‚¹ä½æ•°â€åˆ—ã€‘è¿›è¡Œå®ç°ã€‚

### 10.1.åç«¯æ”¹é€ 

SQL è¯­å¥å¦‚ä¸‹ï¼›

```mysql
SELECT
    p.id,
    p.name,
    p.contact_person,
    p.contact_phone,
    p.profit_share,
    p.account,
    p.password,
    p.create_time,
    p.update_time,
    p.create_by,
    p.update_by,
    p.remark,
    COUNT(n.id) AS node_count  -- ç»Ÿè®¡æ¯ä¸ªåˆä½œå•†çš„ç‚¹ä½æ•°é‡
FROM partner p
        LEFT JOIN node n ON p.id = n.partner_id  -- è¿æ¥ç‚¹ä½è¡¨
GROUP BY p.id;  -- æŒ‰ç…§åˆä½œå•†çš„ ID åˆ†ç»„
```

VO ç±»è®¾è®¡

dkd-manage/src/main/java/com/dkd/manage/domain/vo/PartnerVO.java

```java
package com.dkd.manage.domain.vo;

import com.dkd.manage.domain.Partner;
import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

@Data
@NoArgsConstructor
@AllArgsConstructor
public class PartnerVO extends Partner {
    // ç‚¹ä½æ•°é‡
    private Integer nodeCount;
}
```

Service å±‚

dkd-manage/src/main/java/com/dkd/manage/service/IPartnerService.java

```java
/**
 * æ­¤æ–¹æ³•ç”¨äºï¼šæŸ¥è¯¢åˆä½œå•†åˆ—è¡¨
 *
 * @param partner åˆä½œå•†
 * @return List<PartnerVO>
 */
List<PartnerVO> partnerVOList(Partner partner);
```

dkd-manage/src/main/java/com/dkd/manage/service/impl/PartnerServiceImpl.java

```java
/**
 * æ­¤æ–¹æ³•ç”¨äºï¼šæŸ¥è¯¢åˆä½œå•†åˆ—è¡¨
 *
 * @param partner åˆä½œå•†
 * @return List<PartnerVO>
 */
@Override
public List<PartnerVO> partnerVOList(Partner partner) {
    return partnerMapper.selectPartnerVOList(partner);
}
```

Mapper å±‚

dkd-manage/src/main/java/com/dkd/manage/mapper/PartnerMapper.java

```java
/**
 * æ­¤æ–¹æ³•ç”¨äºï¼šæŸ¥è¯¢åˆä½œå•†åˆ—è¡¨
 * @param partner partner
 * @return List<PartnerVO>
 */
List<PartnerVO> selectPartnerVOList(Partner partner);
```

Controller å±‚

dkd-manage/src/main/java/com/dkd/manage/controller/PartnerController.java

```java
/**
 * æŸ¥è¯¢åˆä½œå•†ç®¡ç†åˆ—è¡¨
 */
@PreAuthorize("@ss.hasPermi('manage:partner:list')")
@GetMapping("/list")
public TableDataInfo list(Partner partner)
{
    startPage();
    List<PartnerVO> list = partnerService.partnerVOList(partner);
    return getDataTable(list);
}
```

### 10.2.å‰ç«¯æ”¹é€ 

src/views/manage/partner/index.vue

```vue
<el-table-column label="ç‚¹ä½æ•°" align="center" prop="nodeCount" />
```

## åä¸€ã€åˆä½œå•†é‡åˆ¶å¯†ç 

### 11.1.æ¥å£æ–‡æ¡£

åŸºæœ¬ä¿¡æ¯

**Pathï¼š** /manage/partner/resetPwd/:id

**Methodï¼š** GET

æ¥å£æè¿°ï¼š

è¯·æ±‚å‚æ•°

è·¯å¾„å‚æ•°

| å‚æ•°åç§° | ç¤ºä¾‹ | å¤‡æ³¨     |
| -------- | ---- | -------- |
| id       | 1    | åˆä½œå•†ID |

è¿”å›æ•°æ®

| åç§° | ç±»å‹   | æ˜¯å¦å¿…é¡» | é»˜è®¤å€¼ | å¤‡æ³¨     | å…¶ä»–ä¿¡æ¯       |
| ---- | ------ | -------- | ------ | -------- | -------------- |
| msg  | string | å¿…é¡»     |        | è¿”å›å†…å®¹ | mock: æ“ä½œæˆåŠŸ |
| code | number | å¿…é¡»     |        | çŠ¶æ€ç    | mock: 200      |

### 11.2.åç«¯æ”¹é€ 

åœ¨ `PartnerController` æ§åˆ¶å™¨ç±»ä¸­ï¼Œæ–°å¢ `resetPwd` æ–¹æ³•ã€‚

dkd-manage/src/main/java/com/dkd/manage/controller/PartnerController.java

```java
/**
 * æ­¤æ–¹æ³•ç”¨äºï¼šé‡åˆ¶åˆä½œå•†å¯†ç 
 *
 * @param id åˆä½œå•† Id
 * @return AjaxResult
 */
@PreAuthorize("@ss.hasPermi('manage:partner:edit')")
@Log(title = "åˆä½œå•†ç®¡ç†", businessType = BusinessType.DELETE)
@PutMapping("/resetPwd/{id}")
public AjaxResult resetPwd(@PathVariable Long id) {
    // åˆ›å»ºåˆä½œå•†å¯¹è±¡
    Partner partner = new Partner();
    partner.setId(id);
    partner.setPassword(SecurityUtils.encryptPassword("123456"));
    // è°ƒç”¨ä¿®æ”¹æ–¹æ³•ä¿®æ”¹å¯†ç 
    return toAjax(partnerService.updatePartner(partner));
}
```

### 11.3.å‰ç«¯æ”¹é€ 

æ·»åŠ ä¸€ä¸ªç½‘ç»œè¯·æ±‚ï¼Œç”¨äºé‡ç½®å¯†ç ï¼š

src/api/manage/partner.js

```js
// é‡åˆ¶å¯†ç 
export function resetPwd(id) {
  return request({
    url: '/manage/partner/resetPwd/' + id,
    method: 'put'
  })
}
```

åœ¨å‰ç«¯è§†å›¾ç»„ä»¶ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªâ€œé‡ç½®å¯†ç â€æŒ‰é’®ï¼š

src/views/manage/partner/index.vue

```vue
<el-table-column label="æ“ä½œ" align="center" class-name="small-padding fixed-width" width="300px">
  <template #default="scope">
    <el-button
      link
      type="primary"
      @click="handleResetPwd(scope.row)"
      v-hasPermi="['manage:partner:edit']"
      >é‡ç½®å¯†ç </el-button
    >
  </template>
  â€¦â€¦
</el-table-column>

<script>
â€¦â€¦

/** é‡åˆ¶å¯†ç  */
function handleResetPwd(row) {
  const _id = row.id
  proxy.$modal
    .confirm('æ‚¨ç¡®å®šé‡åˆ¶è¯¥åˆä½œå•†çš„å¯†ç å—ï¼Ÿ')
    .then(() => {
      return resetPwd(_id)
    })
    .then(() => {
      proxy.$modal.msgSuccess('é‡ç½®æˆåŠŸ')
    })
    .catch(() => {})
}

â€¦â€¦
</script>
```

- `<el-table-column>` æ ‡ç­¾ä¸Šçš„ `width="300px"` å±æ€§ï¼Œç”¨äºå¢åŠ åˆ—çš„å®½åº¦ã€‚
